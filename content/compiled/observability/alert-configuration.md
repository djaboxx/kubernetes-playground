# Alert Configuration

## Alertmanager
Alertmanager is a component of the Prometheus ecosystem that handles alerts generated by Prometheus. It takes care of deduplicating, grouping, and routing alerts to the correct receiver integrations such as email, Slack, or PagerDuty.

## Configuring Alerts

### Creating an Alerting Rule
To create an alerting rule, you need to define the conditions under which an alert should be triggered. This is done using Prometheus' expression language (PromQL). Here is an example of an alerting rule that triggers an alert when CPU usage is above 80% for more than 5 minutes:

```yaml
groups:
- name: example-alerts
  rules:
  - alert: HighCPUUsage
    expr: node_cpu_seconds_total{mode="idle"} < 20
    for: 5m
    labels:
      severity: critical
    annotations:
      summary: "High CPU usage detected"
      description: "CPU usage is above 80% for more than 5 minutes."
```

Apply the rule:
```sh
kubectl apply -f alerting-rules.yaml
```

### Configuring Alertmanager
To configure Alertmanager, you need to create a configuration file that defines how alerts should be handled. Here is an example configuration file:

```yaml
global:
  resolve_timeout: 5m

route:
  group_by: ['alertname']
  group_wait: 30s
  group_interval: 5m
  repeat_interval: 3h
  receiver: 'slack-notifications'

receivers:
- name: 'slack-notifications'
  slack_configs:
  - api_url: 'https://hooks.slack.com/services/T00000000/B00000000/XXXXXXXXXXXXXXXXXXXXXXXX'
    channel: '#alerts'
    send_resolved: true
```

Apply the configuration:
```sh
kubectl apply -f alertmanager-config.yaml
```

## Links to Relevant External Documentation and Resources
- [Prometheus Alerting](https://prometheus.io/docs/alerting/latest/overview/)
- [Alertmanager Configuration](https://prometheus.io/docs/alerting/latest/configuration/)
- [PromQL Documentation](https://prometheus.io/docs/prometheus/latest/querying/basics/)
